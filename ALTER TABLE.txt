
BEGIN
pkg_etl_ce_transmission_types.load_ce_transmission_types;
END pkg_etl_ce_transmission_types;


SELECT *
FROM bl_3nf.CE_TRANSMISSION_TYPES;



SELECT COUNT(*)
FROM bl_3nf.CE_CUSTOMERS;




BEGIN
pkg_etl_ce_employees.load_ce_employees;
END pkg_etl_ce_employees;




SELECT COUNT(*)
FROM bl_3nf.CE_employees;




select count(*)
from
(
select car_id, count(car_id)
from sa_source2.sa_scr_source2
group by car_id
having count(car_id)>1
);










select count(*)
from bl_dm.dim_employees;












select count(*)
from bl_3nf.ce_employees;


select count(*)
from (


SELECT DISTINCT S2.EMPLOYEE_ID, S2.EMPLOYEE, 'sa_source2' AS SOURCE_SYSTEM, 
            'SA_SCR_SOURCE2' AS SOURCE_TABLE FROM SA_SOURCE2.SA_SCR_SOURCE2 S2
            
            
            )
            
            






select count(*) from sa_source2.sa_scr_source2 ;


select count(*)
from
(
select car_id, count(car_id)
from sa_source2.sa_scr_source2
group by car_id
having count(car_id)>1
);



select count(*)
from
(
select MODEL_D_id,  MODEL_D
from sa_source2.sa_scr_source2
group by MODEL_D_id,  MODEL_D
having count(car_id)>1
);


select count(*)
from
(
select FUEL_ID,  FUEL
from sa_source2.sa_scr_source2
group by FUEL_ID,  FUEL
having count(FUEL_ID)>1
);




group by car_id
having count(car_id)>1

update table sa_source.sa
set manufacturer_id = '100'
where manufacturer='audi';





ALTER TABLE ce_states
    drop COLUMN country_id;
    
drop table CE_COUNTRIES;    

ALTER TABLE ce_cities
    drop COLUMN state_id;
    
drop table ce_states;   


ALTER TABLE ce_cities
    drop CONSTRAINT ce_state_fk;
    
 ALTER TABLE ce_states
    drop CONSTRAINT ce_country_fk;   


ALTER TABLE ce_cities
    drop CONSTRAINT ce_state_fk;
    
    
    FOREIGN KEY ( customer_id )
    REFERENCES ce_customers(customer_id);


CREATE OR REPLACE PUBLIC SYNONYM ce_countries FOR BL_3NF.ce_countries;

CREATE TABLE ce_countries 
      (
        country_id                            NUMBER             NOT NULL,
        country_srcid                         VARCHAR2(60)       NOT NULL,
        country                               VARCHAR2(60)       NOT NULL,
	state_id			      NUMBER 		 NOT NULL,
        source_system                         VARCHAR2(60) 	 NOT NULL,
        source_table                          VARCHAR2(60) 	 NOT NULL,
        insert_dt                             DATE  NOT NULL,
        update_dt                             DATE NOT NULL ,
CONSTRAINT country_id_pk PRIMARY KEY (country_id )
       );


ALTER TABLE ce_countries
    drop column  state_id;
    



CREATE TABLE ce_states
    (
    state_id                           	  NUMBER 		NOT NULL,
    state_srcid                           VARCHAR2 (60) 	NOT NULL,
    state_name                            VARCHAR2(40) 		NOT NULL,
    country_id                            NUMBER 		NOT NULL,
    source_system                         VARCHAR2(60) 		NOT NULL,
    source_table                          VARCHAR2(60) 		NOT NULL,
    insert_dt                             DATE NOT NULL ,
    update_dt                             DATE NOT NULL ,
    PRIMARY KEY(state_id ), 
    FOREIGN KEY (country_id) REFERENCES ce_countries (country_id)    
    );  



ALTER TABLE ce_cities
    add state_id number ;
    

ALTER TABLE ce_cities
    add state_id number ;
    
ALTER TABLE ce_cities
    ADD CONSTRAINT ce_state_id_fk 
    FOREIGN KEY (state_id)
    REFERENCES ce_states(state_id);   